---
title:  "Linux学习文档资料"
---
## 实用命令
1. Centos查看包里面包含文件
```shell
[test@manager1 ~]$ yum group info "Development Tools"
```


## 网络文章列表

1. [whatis,whereis,which命令](http://www.thegeekstuff.com/2013/04/linux-which-whatis-whereis/)

2. [CentOS7下Samba的安装与配置 ](http://wangzhijian.blog.51cto.com/6427016/1698879)

3. [Install And Configure Samba Server In CentOS 7](https://www.unixmen.com/install-configure-samba-server-centos-7/)

4. [Sqlite3 命令行操作](https://sqlite.org/cli.html)

5. [Bash自动补全插件](https://www.cyberciti.biz/faq/fedora-redhat-scientific-linuxenable-bash-completion/)
    ```shell
    # yum install bash-completion bash-completion-extras
    ```

6. [Linux bash shell命令行](https://ss64.com/bash/)

7. [explainshell](https://explainshell.com/)

8. linux下的EOF

    EOF是END Of File的缩写,表示自定义终止符

##### 几个特殊符号的解释

   \<\<: 标准输入来自命令行的一对分隔号的中间内容

   \>\>: 输出重定向,进行追加,不会覆盖之前内容  
   ```shell
           #使用形式例如：
           <<EOF        //开始
           ....
           EOF          //结束
       
           #向文件test.sh里输入内容。
           [root@slave-server opt]# cat << EOF >test.sh 
           > 123123123
           > 3452354345
           > asdfasdfs
           > EOF
   ```
##### 重定向和管道的区别，[参考答案](https://askubuntu.com/questions/172982/what-is-the-difference-between-redirection-and-pipe)

+ 重定向到文件或者流（比如：console输入输出流）
+ 两个程序间使用管道

9. 关于`here-document`的解释

    Shell（包括 bash）还有存在 *here-document* 的概念，它是另一种输入重定向形式

10. linux下使用shell脚本查询sqlite3数据库

  ```shell
  #!/bin/bash
  # shell脚本中查询sqlite的第一种方式
  #sqlite3 /root/github/game-play-simulator-request/dist/data.db 'select i.period,i.investNumberCount,i.currentAccountBalance,i.winMoney,i.status,i.isWin,i.investTime from invest i limit 25'

  # shell脚本中查询sqlite的第二种方式
  sqlite3 /root/github/game-play-simulator-request/dist/data.db << EOF
  .mode column
  select i.period,i.investNumberCount,i.currentAccountBalance,i.winMoney,i.status,i.isWin,i.investTime from invest i limit 25;
  EOF
  ```

11. Linux下安装nginx
    ```shell
    $ sudo yum install nginx
    ```

    启动或者停止nginx
    ```shell
    #启动
    $ sudo systemctl start nginx
    #停止
    $ sudo systemctl stop nginx
    #查看状态
    $ sudo systemctl status nginx
    ```

    设置nginx开机启动
    ```shell
    $ sudo systemctl enable nginx
    ```

    修改nginx配置
    ```shell
    $ sudo vi /etc/nginx/nginx.conf
    ```

12. `stat`显示文件或者系统状态，包括文件的大小信息，修改信息等

    ```shell
    stat 文件名
    ```

13. `wc`显示文件大小

    ```shell
    wc -c 文件名  # 已字节的形式显示文件大小
    ```

14. `shell`脚本中变量的引用

    ```shell
    # a=1定义变量并赋值  
    a=1

    # 引用变量的值并输出
    #第1种方式没有加引号，这种方式有风险，如果变量名由多个字母组成，在比较的时候有肯能会被拆分，但是测试的时候并没法发现有这种风险
    echo $a  
    #【推荐方式】第2种方式加引号
    echo "$a"
    #第3种方式用花括号(brace)来引用，花括号的方式是最灵活的，因为它可以有很多对变量的扩展处理
    echo ${a}

    # 某个命令的输出赋值给变量
    # 将pwd命令的输出结果作为值赋值给a变量
    a=$(pwd)
    #引用变量值并输出
    echo $a
    ```

15. `shell`变量扩展方法，[参照文档](https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html)

    ```shell
    #定义变量
    string=01234567890abcdefgh
    #下面的${string:7}实现了字符串变量string的截取功能
    echo ${string:7}  # 输出结果：7890abcdefgh

    ```

16. 符号英文术语

    ```
    Brackets []
    Parentheses ()
    Braces {}
    (Double) Quotation marks ""
    (Single) Quotation marks (apostrophes) ''
    Backticks `` (Same as the tilde ~ key)
    ```

17. `[`在`linux`中是一个命令

    `[`实际上是一个内置命令，可以通过`man [`的方式来查看

    ```shell
    # [ ]和 [[ ]] 的功能是一样的
    $ VARIABLE=abcdef
    $ if [ $VARIABLE == abcdef ] ; then echo yes ; else echo no ; fi
    yes

    # ()可以执行子shell，不受当前shell的影响
    $ pwd
    /home/user 
    $ (cd /tmp; pwd)
    /tmp
    $ pwd
    /home/user

    # {}可以在当前shell中，执行一系列shell命令
        $ { date; top -b -n1 | head ; } >logfile 
        # 'date' and 'top' output are concatenated, 
        # could be useful sometimes to hunt for a top loader )

        $ { date; make 2>&1; date; } | tee logfile
        # now we can calculate the duration of a build from the logfile
    # [ ]  里面的内容会被shell作为命令来处理，前后要有空格
    if [ "$file" == "" ] # 正确的
    if ["$file" == ""] # 不能这么写,shell无法解析，[ 后和 ]前必须有空格
    ```

18. 通过`help test`来查看支持的表达式运算符

    ```shell
    $ help test
    .....
    rg1 OP arg2   Arithmetic tests.  OP is one of -eq, -ne,
                         -lt, -le, -gt, or -ge.
                         
    .....
    ```

19. `+`命令选项标识

    `+`除了有运算功能外，还可以作为命令选项的标识，如下面日期的例子

    ```shell
    $ date +%F
    ```

20. Shell命令传递参数

    参考文章链接：[How to Pass Arguments to a Bash-Script](https://www.lifewire.com/pass-arguments-to-bash-script-2200571)

    ```shell
    #shell中用$1,$2,$3...来代表输入的参数，多个参数依次类推

    #判断是否有输入参数
    if [ "$#" -eq 0 ]   #其中$#代表输入参数的总个数，等于0代表没有输入参数

    #判断字符是否为空
    if [ -z "$1" ]  #第一个参数如果为空，说明没有任何输入参数
    ```

21. #### Centos7.2 配置JRE环境

    1. 下载jre包

       ```shell
       http://download.oracle.com/otn-pub/java/jdk/8u161-b12/2f38c3b165be4555a1fa6e98c45e0808/jre-8u161-linux-x64.tar.gz?AuthParam=1522466532_733393a35d001b50e2c0c0b246b98d9f
       ```

    2. 解压tar包

       ```shell
       tar zxvf jre-8u161-linux-x64.tar.gz
       ```

    3. 配置环境变量 /etc/profile

       ```shell
       vi /etc/profile
       ```

    4. 添加Java环境变量

       在/etc/profile的文件末尾添加如下环境变量：

       ```shell
       export JRE_HOME=/你的jRE安装路径
       export PATH=$PATH:$JRE_HOME/bin
       ```

    5. 生效环境变量

       ```shell
       source /etc/profile
       ```

    6. 检查是否配置成功

       ```shell
       java -version

       输出：
       java version "1.8.0_161"
       Java(TM) SE Runtime Environment (build 1.8.0_161-b12)
       Java HotSpot(TM) 64-Bit Server VM (build 25.161-b12, mixed mode)
       ```

22. #### Centos 7.2 安装MySql环境

    参考官方安装文档：https://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/

    1. 下载 Mysql yum包，页面地址：http://dev.mysql.com/downloads/repo/yum/，如果是64位系统，直接执行下面的命令，下载到本地

       ```shell
       wget http://repo.mysql.com/mysql57-community-release-el7-11.noarch.rpm
       ```

    2. 添加MySQL Yum Repository，安装上步下载的rpm

       ```shell
       sudo rpm -Uvh mysql57-community-release-el7-11.noarch.rpm
       ```

    3. 安装mysql服务端

       ```shell
       sudo yum install mysql-community-server
       ```

    4. 启动mysql服务

       ```shell
       sudo service mysqld start   //启动服务
       sudo service mysqld status  //查看是否启动成功
       ```

    5. 修改root密码

       mysql 5.7首次启动时会生成一个临时密码，首次可以用这个临时密码登录mysql，登录后修改成自己的密码

       ```mysql
       sudo grep 'temporary password' /var/log/mysqld.log   //查看首次启动生成的临时密码

       mysql -uroot -p    //用上面查看到的临时密码登录
       ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!';   //修改密码为MyNewPass4!
       ```

       ​

23. #### Centos 7.2 安装tomcat环境

    1. 下载tomcat9.0安装包

       ```shell
       wget https://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-9/v9.0.6/bin/apache-tomcat-9.0.6.tar.gz
       ```

    2. 解压tar

       ```shell
       tar -zxvf apache-tomcat-9.0.6.tar.gz
       ```

    3. 启动tomcat，前提保证java环境都已经安装成功

       切换到tomcat安装目录的bin目录下，执行

       ```shell
       ./startup.sh
       ```

    4. 查看tomcat运行状态

       ```shell
       systemctl status tomcat
       ```

    5. Centos 7.2下设置开机启动[尝试后未成功]

       ```shell
       #1.在/etc/rc.d/init.d目录下新建tomcat.sh文件，文件内容如下：

       #2.使用命令chkconfig设置开机启动

       ```

24. #### Nginx实现tomcat负载

    1. 只一台机器的情况，只需要设置proxy_pass具对应的物理路径即可，找到http下的server节点中的location，配置如下：

       ```shell
           server {
               .....省略无用的
               
               location / { # / 代表匹配所有请求
                 # 一台机器，只需要添加如下proxy_pass即可
                 proxy_pass  http://localhost:8080;  # 对应tomcat转发的物理路径
               }
               .....省略无用的
           }

       ```

       > 1. http下的server节点相当于一个代理服务器，可以有多个代理服务器
       > 2. server_name 是暴露给客户端的域名，如果是本地就写localhost
       > 3. 集群配置参考文档地址: https://blog.csdn.net/qq_18279123/article/details/54928999

    2. 有2台或以上的机器配置，也很简单，只需要添加upstream节点，然后把proxy_pass的值指向该upstream节点对应的名称即可，**注意：1. 在upstream中没有http://协议头。 2. upstream名称中最好不要带下划线之类的 3. 名字可以包含点符号，最好是用对外暴露的域名名称，避免代码中获取服务器名称的时候有问题，也可以通过proxy_set_header来避免这个问题**有可能导致访问服务器失败，自己踩过的坑

       ```shell
           # 在这里添加集群机器的ip地址
           upstream localtomcat {
               server localhost:8080;
           }
           
               server {
               .....省略无用的
               
               location / { # / 代表匹配所有请求
                 proxy_pass  http://localtomcat;  # 对应upstream名称，建议填对应域名，也可以通过proxy_set_header来避免这个问题
               }
               .....省略无用的
           }
           
       ```

    3. 【可选配置】可能需要用到的配置，如果不配置的话，服务端代码中客户端ip地址都是nginx服务器地址，可以参考[nginx反向代理，request.getServerName()的问题](https://blog.csdn.net/lxl631/article/details/42004349)

       ```shell
       nginx反向代理配置时，一般会添加下面的配置：  
             proxy_set_header Host $host;  
             proxy_set_header X-Real-IP $remote_addr;  
             proxy_set_header REMOTE-HOST $remote_addr;  
             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; 
       ```

    4. 配置完成后重新加载配置

       ```shell
       nginx -s reload
       ```

25. #### Tomcat服务器返回的验证码乱码

    1. 可能是字体的问题，需要拷贝windows字体到centos字体库中，在/usr/share/fonts

       目录下新建一个目录，并通过chmod  -R 755 目录名称 给目录添加权限，完成后更新字体缓存并重启机器

       ```shell
       cd /usr/share/fonts/

       # 创建目录并添加权限
       mkdir winfonts
       cd ..
       chmod -R 755 winfonts/

       # 更新字体缓存
       yum install mkfontscale
       sudo mkfontscale
       sudo mkfontdir
       sudo fc-cache -fv

       # 让字体生效
       source /etc/profile

       # 重启centos
       shutdown -r
       ```

       > 参考文档：
       >
       > 1. [Linux(CentOS6.5)系统安装Windows字体](https://blog.csdn.net/irokay/article/details/50539579)

26. #### CentOS7.2 配置Maven环境

    1. 下载mavenhttp://mirror.bit.edu.cn/apache/maven/maven-3/3.5.3/binaries/apache-maven-3.5.3-bin.tar.gz
    2. 设置MAVEN_HOME环境变量，设置后使用source命令生效环境变量
    3. 编译项目，首先切换到项目根目录，执行mvn package，执行该命令会自动下载依赖包，并自动打包项目

27. #### Tomcat服务器默认主页修改

    方法一：超级简单的方法

    将webapps/Root中的index.jsp替换成如下内容，修改其中对应的url地址即可

    ```html
    <html>

    <head>
    <meta http-equiv="refresh" content="0;URL=http://mydomain.com/some/path/to/servlet/homepage/">
    </head>

    <body>
    </body>

    </html>
    ```


    参考文章：[How do I override the default home page loaded by Tomcat?](https://wiki.apache.org/tomcat/HowTo#How_do_I_override_the_default_home_page_loaded_by_Tomcat.3F)

    方法二：配置conf/server.xml文件，在Host节点中添加

    ```xml
    <!--第一步：配置Context路径  path属性留空，path没有实际用途，暂时没找到使用方法--> 
    <Context path="" docBase="在webapps中的目录名称" debug="0" reloadable="true"/>

    <!--第二步: 给你的程序配置一个index.html的路由，这个路由指向你的主页-->
    ```

    ​

