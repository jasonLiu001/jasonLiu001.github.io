---
title: "CentOS新服务器环境配置"
---

最好的解决方案是编写一个shell脚本，一次执行不要手工单独安装

1. 安装`node`  参考文档：<https://nodejs.org/en/download/package-manager/>

   Run as root on RHEL, CentOS or Fedora, for Node.js v6 LTS:

   ```shell
   curl --silent --location https://rpm.nodesource.com/setup_6.x | bash -
   ```

   Then install, as root:

   ```shell
   yum -y install nodejs
   ```

2.  安装`cnpm`，如果通过`npm`安装的话，`electron`在安装的时候可能安装不完成，会导致运行出错

   ```shell
    npm install -g cnpm --registry=https://registry.npm.taobao.org
   ```

   参考文档：<https://github.com/electron/electron/blob/master/docs/development/build-instructions-linux.md>

3. 安装编译环境

   To compile and install native addons from npm you may also need to install build tools:

   ```shell
   # 或者安装整个开发工具包，推荐这个
   yum groupinstall 'Development Tools'

   # 只安装gcc make
   # yum install gcc-c++ make

   ```

4.  安装`electron`的`centos`依赖

   ```shell
   $ sudo yum install clang dbus-devel gtk2-devel libnotify-devel \
                      libgnome-keyring-devel xorg-x11-server-utils libcap-devel \
                      cups-devel libXtst-devel alsa-lib-devel libXrandr-devel \
                      GConf2-devel nss-devel
   ```

5. 安装ntpdate，执行以下命令

   ```shell
   # yum install ntpdate -y  ##CentOS安装
   # sudo apt-get install ntp  ##Ubuntu安装
   ```

6. 使用crontab计划任务定时更新网络时间

   ```shell
   # vi /etc/crontab
   ```

7. 在打开文件的末尾添加定时任务，每天早上6点执行时间同步，如下所示：

   ```shell
   0  6  *  *  * root ntpdate ntp1.aliyun.com   ##CentOS
   0  6  *  *  * ntpd ntp1.aliyun.com   ##Ubuntu
   ```

   其中`ntp1.aliyun.com`是阿里的时间同步服务器，也可以根据自己的需要选择其他的，在`Linux`下设置好时间同步后，还要设置程序的自动运行时间，周一到周五运行正式程序，周六、周日两天运行模拟程序

   ```shell
   0 2 * * 1-5 killall node
   56 9 * * 1-5 sh ~/start.sh
   0 2 * * 6,0 killall node
   56 9 * * 6,0 sh ~/mock.sh
   ```

   `CentOS`下设置定时任务可通过`crontab -e`命令来设置，设置好后会自动生效，通过`crontab -l`查看当前用户所有的定时任务

   *下面是`start.sh`中的内容*

   ```shell
   #!/bin/bash
   cd /home/liuwang/github/game-play-simulator-request
   rm -rf nohup.out
   rm -rf npm-debug.log
   nohup npm run linux:start &
   ```

8. 安装`sz/rz`下载/上传

   如果当前`Linux`版本上已经支持`sz/rz`命令，则不需要重复安装，在`CentOS`下安装`sz/rz`命令

   ```shell
   yum install lrzsz  ##CentOS
   sudo apt-get install lrzsz  ##Ubuntu
   ```

+ 下载文件

   ```shell
   sz 文件名
   ```

+ 上传文件

   ```shell
   rz -ary --o-sync
   ```
9. 安装Bash自动补全工具
   ```shell
   #确认已经安装了epel-release
   yum install epel-release
   # yum install bash-completion bash-completion-extras
   ```
