---
title: "微信小程序开发笔记"
date: 2017-11-30 16:21:00 +0800
---

#### `wx.authorize`

该授权接口可以多次调用，接口内部已经有处理，例如如下代码：

```javascript
wx.getSetting({
    success(res) {
     /*
        下面的wx.authorize在res.authSetting['scope.record']两种值的情况下会调用
        	1. undefined--用户未授权
        	2. false--用户之前已拒绝授权
     */      
        if (!res.authSetting['scope.record']) {
            wx.authorize({
                scope: 'scope.record',
                success() {
                    // 用户已经同意小程序使用录音功能，后续调用 wx.startRecord 接口不会弹窗询问
                    wx.startRecord()
                }
            })
        }
    }
})
```
#### 微信模板使用

+ 模板导入：import -- 引入的目标文件通过template定义的

  ```html
  <import src="item.wxml"/>
  <template is="item" data="{{text: 'forbar'}}"/>
  ```

+ 代码片段导入：include -- 和import不同，它引入的是代码片段。非template或wxs定义的代码片段

#### 小程序中的数据绑定是单向的，并不是双向的

小程序实现了单向数据绑定，Model中的值改变，View能够发生变化。但是View发生变化的时候，Model中的值并没有相应的变化，需要利用bindinput这类的事件处理函数来手动更新Model中对应的值

#### setData方法可以给未在Model中定义的对象赋值

```javascript
<!--view部分-->
<view hidden="{{isHidden}}"></view>

<!--JS部分-->
Page({
  data:{},
  onLoad:function(){
      this.setData({isHidden:true});
  }
})
```

上面的代码中`isHidden`并没有在`Page`对象中的`data`里定义，但是通过`setData`方法仍然可以操作`View`中绑定的`isHidden`的值

#### APP 生命周期中onhide调用时机

1. 关闭小程序时会调用（点左上角的叉）
2. 点击手机返回键

#### 组件上由`data-`开头的自定义属性不支持大学，只支持小写模式

下面是官方给的示例，里面有大写字母，这是个**深坑**，经过测试如果`data-`后面的部分有大写字母，通过`event.currentTarget.dataset`属性获取不到，始终是`undefined`

```html
<!--官方示例 经测试无效-->
<view data-alpha-beta="1" data-alphaBeta="2" bindtap="bindViewTap"> DataSet Test </view>

<!--正确的  data-alphaBeta改成data-alphabeta即可正常使用 -->
<view data-alpha-beta="1" data-alphabeta="2" bindtap="bindViewTap"> DataSet Test </view>
```

